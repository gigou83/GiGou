Here is the core of 3d-engine 